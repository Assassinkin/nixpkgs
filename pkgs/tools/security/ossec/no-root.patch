diff -Naur ossec-hids-2.7-orig/install.sh ossec-hids-2.7/install.sh
--- ossec-hids-2.7-orig/install.sh	2012-11-08 21:24:55.000000000 -0500
+++ ossec-hids-2.7/install.sh	2018-05-16 06:54:52.443214161 -0400
@@ -121,15 +121,14 @@
     # Generate the /etc/ossec-init.conf
     VERSION_FILE="./src/VERSION"
     VERSION=`cat ${VERSION_FILE}`
-    chmod 700 ${OSSEC_INIT} > /dev/null 2>&1
-    echo "DIRECTORY=\"${INSTALLDIR}\"" > ${OSSEC_INIT}
-    echo "VERSION=\"${VERSION}\"" >> ${OSSEC_INIT}
-    echo "DATE=\"`date`\"" >> ${OSSEC_INIT}
-    echo "TYPE=\"${INSTYPE}\"" >> ${OSSEC_INIT}
-    chmod 600 ${OSSEC_INIT}
-    cp -pr ${OSSEC_INIT} ${INSTALLDIR}${OSSEC_INIT}
-    chmod 640 ${INSTALLDIR}${OSSEC_INIT}
-
+    echo chmod 700 ${OSSEC_INIT} > /dev/null 2>&1
+    echo "DIRECTORY=\"${INSTALLDIR}\"" > ${INSTALLDIR}${OSSEC_INIT}
+    echo "VERSION=\"${VERSION}\"" >> ${INSTALLDIR}${OSSEC_INIT}
+    echo "DATE=\"`date`\"" >> ${INSTALLDIR}${OSSEC_INIT}
+    echo "TYPE=\"${INSTYPE}\"" >> ${INSTALLDIR}${OSSEC_INIT}
+    echo chmod 600 ${OSSEC_INIT}
+    echo cp -pr ${OSSEC_INIT} ${INSTALLDIR}${OSSEC_INIT}
+    echo chmod 644 ${INSTALLDIR}${OSSEC_INIT}
 
     # If update_rules is set, we need to tweak
     # ossec.conf to read the new signatures.
@@ -972,10 +971,6 @@
         catError "0x1-location";
     fi
 
-    # Must be root
-    if [ ! "X$ME" = "Xroot" ]; then
-        catError "0x2-beroot";
-    fi
 
     # Checking dependencies
     checkDependencies
diff -Naur ossec-hids-2.7-orig/src/init/ossec-client.sh ossec-hids-2.7/src/init/ossec-client.sh
--- ossec-hids-2.7-orig/src/init/ossec-client.sh	2012-11-08 21:24:55.000000000 -0500
+++ ossec-hids-2.7/src/init/ossec-client.sh	2018-05-16 12:02:01.231907541 -0400
@@ -3,7 +3,6 @@
 #                      or stopping ossec-hids
 # Author: Daniel B. Cid <daniel.cid@gmail.com>
 
-
 LOCAL=`dirname $0`;
 cd ${LOCAL}
 PWD=`pwd`
@@ -17,7 +16,7 @@
 
 
 ## Locking for the start/stop
-LOCK="${DIR}/var/start-script-lock"
+LOCK="/var/ossec/start-script-lock"
 LOCK_PID="${LOCK}/pid"
 
 
@@ -32,11 +31,11 @@
 checkpid()
 {
     for i in ${DAEMONS}; do
-        for j in `cat ${DIR}/var/run/${i}*.pid 2>/dev/null`; do
+        for j in `cat /var/run/${i}*.pid 2>/dev/null`; do
             ps -p $j |grep ossec >/dev/null 2>&1
             if [ ! $? = 0 ]; then
-                echo "Deleting PID file '${DIR}/var/run/${i}-${j}.pid' not used..."
-                rm ${DIR}/var/run/${i}-${j}.pid
+                echo "Deleting PID file '/var/run/${i}-${j}.pid' not used..."
+                rm /var/run/${i}-${j}.pid
             fi    
         done    
     done    
@@ -138,13 +137,21 @@
     for i in ${SDAEMONS}; do
         pstatus ${i};
         if [ $? = 0 ]; then
-            ${DIR}/bin/${i};
-            if [ $? != 0 ]; then
-                unlock;
-                exit 1;
-            fi 
-
-            echo "Started ${i}..."            
+            if [ -z $conf_file ]; then
+               ${DIR}/bin/${i};
+               if [ $? != 0 ]; then
+                   unlock;
+                   exit 1;
+               fi 
+            else
+               ${DIR}/bin/${i} -c $conf_file;
+               if [ $? != 0 ]; then
+                   unlock;
+                   exit 1;
+               fi
+            fi
+            echo "Started ${i}..."
+                        
         else
             echo "${i} already running..."                
         fi    
@@ -168,13 +175,13 @@
         return 0;
     fi
         
-    ls ${DIR}/var/run/${pfile}*.pid > /dev/null 2>&1
+    ls /var/run/${pfile}*.pid > /dev/null 2>&1
     if [ $? = 0 ]; then
-        for j in `cat ${DIR}/var/run/${pfile}*.pid 2>/dev/null`; do
+        for j in `cat /var/run/${pfile}*.pid 2>/dev/null`; do
             ps -p $j |grep ossec >/dev/null 2>&1
             if [ ! $? = 0 ]; then
                 echo "${pfile}: Process $j not used by ossec, removing .."
-                rm -f ${DIR}/var/run/${pfile}-$j.pid
+                rm -f /var/run/${pfile}-$j.pid
                 continue;
             fi
                 
@@ -199,12 +206,12 @@
         if [ $? = 1 ]; then
             echo "Killing ${i} .. ";
             
-            kill `cat ${DIR}/var/run/${i}*.pid`;
+            kill `cat /var/run/${i}*.pid`;
         else
             echo "${i} not running .."; 
         fi
         
-        rm -f ${DIR}/var/run/${i}*.pid
+        rm -f /var/run/${i}*.pid
         
      done    
     
@@ -215,7 +222,20 @@
 
 ### MAIN HERE ###
 
-case "$1" in
+while getopts "f:c:h" o; do
+        case "${o}" in
+                f)
+                        command=${OPTARG}
+                        echo "hhhh";;
+                c)
+                        conf_file=${OPTARG}
+                        echo "dddd";;
+                h)
+                        echo -e 'Usage: -c $conf_file_path'
+                        exit 0;;
+        esac
+done
+case "$command" in
   start)
     testconfig
 	start
diff -Naur ossec-hids-2.7-orig/src/InstallAgent.sh ossec-hids-2.7/src/InstallAgent.sh
--- ossec-hids-2.7-orig/src/InstallAgent.sh	2012-11-08 21:24:55.000000000 -0500
+++ ossec-hids-2.7/src/InstallAgent.sh	2018-05-16 06:54:56.867315005 -0400
@@ -105,31 +105,31 @@
 done
 
 # Default for all directories
-chmod -R 550 ${DIR}
-chown -R root:${GROUP} ${DIR}
+echo chmod -R 550 ${DIR}
+echo chown -R root:${GROUP} ${DIR}
 
 # To the ossec queue (default for agentd to read)
-chown -R ${USER}:${GROUP} ${DIR}/queue/ossec
-chmod -R 770 ${DIR}/queue/ossec
+echo chown -R ${USER}:${GROUP} ${DIR}/queue/ossec
+echo chmod -R 770 ${DIR}/queue/ossec
 
 # For the logging user
-chown -R ${USER}:${GROUP} ${DIR}/logs
-chmod -R 750 ${DIR}/logs
-chmod -R 775 ${DIR}/queue/rids
-touch ${DIR}/logs/ossec.log
-chown ${USER}:${GROUP} ${DIR}/logs/ossec.log
-chmod 664 ${DIR}/logs/ossec.log
-
-chown -R ${USER}:${GROUP} ${DIR}/queue/diff
-chmod -R 750 ${DIR}/queue/diff
-chmod 740 ${DIR}/queue/diff/* > /dev/null 2>&1
+echo chown -R ${USER}:${GROUP} ${DIR}/logs
+echo chmod -R 750 ${DIR}/logs
+echo chmod -R 775 ${DIR}/queue/rids
+echo touch ${DIR}/logs/ossec.log
+echo chown ${USER}:${GROUP} ${DIR}/logs/ossec.log
+echo chmod 664 ${DIR}/logs/ossec.log
+
+echo chown -R ${USER}:${GROUP} ${DIR}/queue/diff
+echo chmod -R 750 ${DIR}/queue/diff
+echo chmod 740 ${DIR}/queue/diff/* > /dev/null 2>&1
 
 
 
 
 # For the etc dir
-chmod 550 ${DIR}/etc
-chown -R root:${GROUP} ${DIR}/etc
+echo chmod 550 ${DIR}/etc
+echo chown -R root:${GROUP} ${DIR}/etc
 
 ls /etc/localtime > /dev/null 2>&1
 if [ $? = 0 ]; then
@@ -167,25 +167,25 @@
 cp -pr ../etc/client.keys ${DIR}/etc/ > /dev/null 2>&1
 cp -pr agentlessd/scripts/* ${DIR}/agentless/
 
-chown root:${GROUP} ${DIR}/etc/internal_options.conf
-chown root:${GROUP} ${DIR}/etc/local_internal_options.conf > /dev/null 2>&1
-chown root:${GROUP} ${DIR}/etc/client.keys > /dev/null 2>&1
-chown root:${GROUP} ${DIR}/agentless/*
-chown ${USER}:${GROUP} ${DIR}/.ssh
-chown -R root:${GROUP} ${DIR}/etc/shared
-
-chmod 550 ${DIR}/etc
-chmod 440 ${DIR}/etc/internal_options.conf
-chmod 440 ${DIR}/etc/local_internal_options.conf > /dev/null 2>&1
-chmod 440 ${DIR}/etc/client.keys > /dev/null 2>&1
-chmod -R 770 ${DIR}/etc/shared # ossec must be able to write to it
-chmod 550 ${DIR}/agentless/*
-chmod 700 ${DIR}/.ssh
+echo chown root:${GROUP} ${DIR}/etc/internal_options.conf
+echo chown root:${GROUP} ${DIR}/etc/local_internal_options.conf > /dev/null 2>&1
+echo chown root:${GROUP} ${DIR}/etc/client.keys > /dev/null 2>&1
+echo chown root:${GROUP} ${DIR}/agentless/*
+echo chown ${USER}:${GROUP} ${DIR}/.ssh
+echo chown -R root:${GROUP} ${DIR}/etc/shared
+
+echo chmod 550 ${DIR}/etc
+echo chmod 440 ${DIR}/etc/internal_options.conf
+echo chmod 440 ${DIR}/etc/local_internal_options.conf > /dev/null 2>&1
+echo chmod 440 ${DIR}/etc/client.keys > /dev/null 2>&1
+echo chmod -R 770 ${DIR}/etc/shared # ossec must be able to write to it
+echo chmod 550 ${DIR}/agentless/*
+echo chmod 700 ${DIR}/.ssh
 
 
 # For the /var/run
-chmod 770 ${DIR}/var/run
-chown root:${GROUP} ${DIR}/var/run
+echo chmod 770 ${DIR}/var/run
+echo chown root:${GROUP} ${DIR}/var/run
 
 
 # Moving the binary files
@@ -197,18 +197,18 @@
 cp -pr ./init/ossec-client.sh ${DIR}/bin/ossec-control
 cp -pr ../bin/manage_agents ${DIR}/bin/
 cp -pr ../contrib/util.sh ${DIR}/bin/
-chown root:${GROUP} ${DIR}/bin/util.sh
-chmod +x ${DIR}/bin/util.sh
+echo chown root:${GROUP} ${DIR}/bin/util.sh
+echo chmod +x ${DIR}/bin/util.sh
 
 # Copying active response modules
 sh ./init/fw-check.sh execute > /dev/null
 cp -pr ../active-response/*.sh ${DIR}/active-response/bin/
 cp -pr ../active-response/firewalls/*.sh ${DIR}/active-response/bin/
-chmod 755 ${DIR}/active-response/bin/*
-chown root:${GROUP} ${DIR}/active-response/bin/*
+echo chmod 755 ${DIR}/active-response/bin/*
+echo chown root:${GROUP} ${DIR}/active-response/bin/*
 
-chown root:${GROUP} ${DIR}/bin/*
-chmod 550 ${DIR}/bin/*
+echo chown root:${GROUP} ${DIR}/bin/*
+echo chmod 550 ${DIR}/bin/*
 
 
 # Moving the config file
@@ -224,8 +224,8 @@
 else    
     cp -pr ../etc/ossec-agent.conf ${DIR}/etc/ossec.conf
 fi
-chown root:${GROUP} ${DIR}/etc/ossec.conf
-chmod 440 ${DIR}/etc/ossec.conf
+echo chown root:${GROUP} ${DIR}/etc/ossec.conf
+echo chmod 440 ${DIR}/etc/ossec.conf
 
 
 

